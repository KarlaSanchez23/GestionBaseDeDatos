--Cuando fallece un cliente, por politica de la empresa en la base de datos no se puede eliminar
--al mismo definitivamente por determinados periodos, pero tampoco es ético dejar el cliente muerto en el registro 
--de clientes, para ello, cree un trigger que al eliminar un cliente fallecido, se almacene en otra tabla.

-- crear la funcion que retorne el trigger
create or replace function insertar_trigger() RETURNS TRIGGER AS $insertar$
declare begin
--antes de que elimine el registro, lo guarde en la tabla fallecidos
	insert into FALLECIDOS values (old.idcliente, old.cli_nombre, old.fecha_nacimiento,old.ciudad);
	return null;
end;

$insertar$ language plpgsql;

--crear el trigger
create trigger insertar_fallecidos before delete
on cliente for each row
--llamar a la función
execute procedure insertar_trigger();

delete from cliente where idcliente='6';



create table fallecidos(
codigo_fa int not null,
nombre_fa varchar (30),
fecha_nacim date,
ciudad varchar(20)

);



Select * from cliente



Select * from fallecidos


