--Crear un cursor que muestre detallado
--E beneficiario, cuanto se le pagó y el METODO de pago correspondiente.

create table DETALLE(
	IDBENEFICIARIO INT NOT NULL,
	BENEFICIARIO VARCHAR(30),
	METODO_PAGO VARCHAR(30),
	CANTIDAD_PAGO NUMERIC(10)

)


--Crear un cursor que muestre detallado
--E beneficiario, cuanto se le pagó y el METODO de pago correspondiente.

-- CREAR EL CURSOR
declare cursor_beneficiario cursor 

for select B.IDBENEFICIARIO, B.NOMBRE, P.TIPO_PAGO,P.CANTIDAD_PAGO 
										
	from BENEFICIARIO AS B JOIN PAGO AS	P
	ON B.IDPAGO = P.IDPAGO 
	GROUP BY B.IDBENEFICIARIO, B.NOMBRE, P.TIPO_PAGO, P.CANTIDAD_PAGO

--ABRIR EL CURSOR
OPEN cursor_beneficiario
declare @idbeneficiario int, @nombre varchar(30), @tipo_pago varchar(30), @cantidad_pago numeric(10)

--EL FETCH NEXT DEVOLVERÁ LA SIGUIENTE FILA DE DATOS
fetch next from cursor_beneficiario INTO @idbeneficiario, @nombre, @tipo_pago, @cantidad_pago

--VERIFICA LA EXISTENCIA DE QUE SE LEYÓ LA FILA
WHILE (@@FETCH_STATUS=0)
BEGIN
	INSERT INTO DETALLE VALUES(@idbeneficiario,@nombre, @tipo_pago,@cantidad_pago);
	FETCH NEXT FROM cursor_beneficiario INTO @idbeneficiario, @nombre, @tipo_pago, @cantidad_pago
END

CLOSE cursor_beneficiario
DEALLOCATE cursor_beneficiario







select * from DETALLE
